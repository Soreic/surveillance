<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Shiryaev-Roberts based prospective spatio-temporal cluster detection
  as in Assuncao &amp;amp; Correa (2009)."><title>Spatio-temporal cluster detection — stcd • surveillance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatio-temporal cluster detection — stcd"><meta property="og:description" content="Shiryaev-Roberts based prospective spatio-temporal cluster detection
  as in Assuncao &amp;amp; Correa (2009)."><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@bastistician"><meta name="twitter:site" content="@bastistician"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">surveillance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.20.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/events.html">Events</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a>
</li>
      </ul><ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Spatio-temporal cluster detection</h1>
      
      <div class="d-none name"><code>stcd.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Shiryaev-Roberts based prospective spatio-temporal cluster detection
  as in Assuncao &amp; Correa (2009).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stcd</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>,<span class="va">t</span>,<span class="va">radius</span>,<span class="va">epsilon</span>,<span class="va">areaA</span>, <span class="va">areaAcapBk</span>, <span class="va">threshold</span>, cusum<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Vector containing spatial x coordinate of the events.</p></dd>

  <dt>y</dt>
<dd><p>Vector containing spatial y coordinate of the events.</p></dd>

  <dt>t</dt>
<dd><p>Vector containing the time points of the events. It is
    assumed that the vector is sorted (early-&gt;last).</p></dd>

  <dt>radius</dt>
<dd><p>Radius of the cluster to detect.</p></dd>

  <dt>epsilon</dt>
<dd><p>Relative change of event-intensity within the cluster
    to detect. See reference paper for an explicit definition.</p></dd>

  <dt>areaA</dt>
<dd><p>Area of the observation region A (single number) -- This
    argument is currently ignored!</p></dd>

  <dt>areaAcapBk</dt>
<dd><p>Area of A \ B(s_k,rho) for all k=1,...,n
    (vector). This argument is currently ignored!</p></dd>

  <dt>threshold</dt>
<dd><p>Threshold limit for the alarm and should be equal to
    the desired Average-Run-Length (ARL) of the detector.</p></dd>

  <dt>cusum</dt>
<dd><p>(logical) If <code>FALSE</code> (default) then the
    Shiryaev-Roberts detector is used as in the original article by
    Assuncao &amp; Correa (2009), i.e. \(R_n = \sum_{k=1}^n
      \Lambda_{k,n}\), where \(\Lambda_{k,n}\) denotes the likelihood
    ratio between the in-control and out-of control model. If
    <code>TRUE</code>, CUSUM test statistic is 
    used instead. Here, $$R_n = \max_{1\leq k \leq n}
      \Lambda_{k,n}$$. Note that this has implications on what threshold
    will sound the alarm (CUSUM threshold needs to be smaller).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Shiryaev-Roberts based spatio-temporal cluster detection based
 on the work in Assuncao and Correa (2009). The implementation
 is based on C++ code originally written by Marcos Oliveira Prates, UFMG,
 Brazil and provided by Thais Correa, UFMG, Brazil during her research
 stay in Munich. This stay was financially supported by the Munich
 Center of Health Sciences.</p>
<p>Note that the vectors <code>x</code>, <code>y</code> and <code>t</code> need to be of the
 same length. Furthermore, the vector <code>t</code> needs to be sorted (to
 improve speed, the latter is not verified within the function).</p> 
<p>The current implementation uses a call to a C++ function to perform the
 actual computations of the test statistic. The function is currently
 experimental -- data type and results may be subject to changes.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with three components</p>
<dl><dt>R</dt>
<dd><p>A vector of the same length as the input containing the value
    of the test statistic for each observation.</p></dd>

  <dt>idxFA</dt>
<dd><p>Index in the x,y,t vector causing a possible alarm. If no
    cluster was detected, then a value of <code>-1</code> is returned here.</p></dd>

  <dt>idxCC</dt>
<dd><p>index in the x,y,t vector of the event containing the
    cluster. If no cluster was detected, then a value of <code>-1</code> is
    returned here.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Assuncao, R. and Correa, T. (2009), Surveillance to detect emerging
space-time clusters, Computational Statistics &amp; Data Analysis,
53(8):2817-2830.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>M. O. Prates, T. Correa and M. Höhle</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://www.maths.lancs.ac.uk/~rowlings/Splancs/" class="external-link">"splancs"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># load the data from package "splancs"</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">burkitt</span>, package<span class="op">=</span><span class="st">"splancs"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># order the times</span></span>
<span>    <span class="va">burkitt</span> <span class="op">&lt;-</span> <span class="va">burkitt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">burkitt</span><span class="op">$</span><span class="va">t</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span>    <span class="co">#Parameters for the SR detection</span></span>
<span>    <span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># relative change within the cluster</span></span>
<span>    <span class="va">radius</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># radius</span></span>
<span>    <span class="va">threshold</span> <span class="op">&lt;-</span> <span class="fl">161</span> <span class="co"># threshold limit</span></span>
<span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">stcd</span><span class="op">(</span>x<span class="op">=</span><span class="va">burkitt</span><span class="op">$</span><span class="va">x</span>,</span>
<span>                y<span class="op">=</span><span class="va">burkitt</span><span class="op">$</span><span class="va">y</span>,</span>
<span>                t<span class="op">=</span><span class="va">burkitt</span><span class="op">$</span><span class="va">t</span>,</span>
<span>                radius<span class="op">=</span><span class="va">radius</span>,</span>
<span>                epsilon<span class="op">=</span><span class="va">epsilon</span>,</span>
<span>                areaA<span class="op">=</span><span class="fl">1</span>,</span>
<span>                areaAcapBk<span class="op">=</span><span class="fl">1</span>,</span>
<span>                threshold<span class="op">=</span><span class="va">threshold</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co">#Index of the event</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">R</span> <span class="op">&gt;=</span> <span class="va">threshold</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Maintained by <a href="http://www.imbe.med.uni-erlangen.de/cms/sebastian_meyer.html" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

    </footer></div>

  

  </body></html>

